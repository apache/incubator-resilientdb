<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: mkdirp</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ResilientDB<span id="projectnumber">&#160;v1.3.1</span>
   </div>
   <div id="projectbrief">NexRes</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/dd6/md__github_workspace_node_modules_mkdirp_readme.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">mkdirp </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Like <code>mkdir -p</code>, but in Node.js!</p>
<p>Now with a modern API and no* bugs!</p>
<p><small>* may contain some bugs</small></p>
<h1><a class="anchor" id="autotoc_md2068"></a>
example</h1>
<h2><a class="anchor" id="autotoc_md2069"></a>
pow.js</h2>
<div class="fragment"><div class="line">const mkdirp = require(&#39;mkdirp&#39;)</div>
<div class="line"> </div>
<div class="line">// return value is a Promise resolving to the first directory created</div>
<div class="line">mkdirp(&#39;/tmp/foo/bar/baz&#39;).then(made =&gt;</div>
<div class="line">  console.log(`made directories, starting with ${made}`))</div>
</div><!-- fragment --><p>Output (where <code>/tmp/foo</code> already exists)</p>
<div class="fragment"><div class="line">made directories, starting with /tmp/foo/bar</div>
</div><!-- fragment --><p>Or, if you don't have time to wait around for promises:</p>
<div class="fragment"><div class="line">const mkdirp = require(&#39;mkdirp&#39;)</div>
<div class="line"> </div>
<div class="line">// return value is the first directory created</div>
<div class="line">const made = mkdirp.sync(&#39;/tmp/foo/bar/baz&#39;)</div>
<div class="line">console.log(`made directories, starting with ${made}`)</div>
</div><!-- fragment --><p>And now /tmp/foo/bar/baz exists, huzzah!</p>
<h1><a class="anchor" id="autotoc_md2070"></a>
methods</h1>
<div class="fragment"><div class="line">const mkdirp = require(&#39;mkdirp&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md2071"></a>
mkdirp(dir, [opts]) -&gt; Promise&lt;String | undefined&gt;</h2>
<p>Create a new directory and any necessary subdirectories at <code>dir</code> with octal permission string <code>opts.mode</code>. If <code>opts</code> is a string or number, it will be treated as the <code>opts.mode</code>.</p>
<p>If <code>opts.mode</code> isn't specified, it defaults to <code>0o777 &amp; (~process.umask())</code>.</p>
<p>Promise resolves to first directory <code>made</code> that had to be created, or <code>undefined</code> if everything already exists. Promise rejects if any errors are encountered. Note that, in the case of promise rejection, some directories <em>may</em> have been created, as recursive directory creation is not an atomic operation.</p>
<p>You can optionally pass in an alternate <code>fs</code> implementation by passing in <code>opts.fs</code>. Your implementation should have <code>opts.fs.mkdir(path, opts, cb)</code> and <code>opts.fs.stat(path, cb)</code>.</p>
<p>You can also override just one or the other of <code>mkdir</code> and <code>stat</code> by passing in <code>opts.stat</code> or <code>opts.mkdir</code>, or providing an <code>fs</code> option that only overrides one of these.</p>
<h2><a class="anchor" id="autotoc_md2072"></a>
mkdirp.sync(dir, opts) -&gt; String|null</h2>
<p>Synchronously create a new directory and any necessary subdirectories at <code>dir</code> with octal permission string <code>opts.mode</code>. If <code>opts</code> is a string or number, it will be treated as the <code>opts.mode</code>.</p>
<p>If <code>opts.mode</code> isn't specified, it defaults to <code>0o777 &amp; (~process.umask())</code>.</p>
<p>Returns the first directory that had to be created, or undefined if everything already exists.</p>
<p>You can optionally pass in an alternate <code>fs</code> implementation by passing in <code>opts.fs</code>. Your implementation should have <code>opts.fs.mkdirSync(path, mode)</code> and <code>opts.fs.statSync(path)</code>.</p>
<p>You can also override just one or the other of <code>mkdirSync</code> and <code>statSync</code> by passing in <code>opts.statSync</code> or <code>opts.mkdirSync</code>, or providing an <code>fs</code> option that only overrides one of these.</p>
<h2><a class="anchor" id="autotoc_md2073"></a>
mkdirp.manual, mkdirp.manualSync</h2>
<p>Use the manual implementation (not the native one). This is the default when the native implementation is not available or the stat/mkdir implementation is overridden.</p>
<h2><a class="anchor" id="autotoc_md2074"></a>
mkdirp.native, mkdirp.nativeSync</h2>
<p>Use the native implementation (not the manual one). This is the default when the native implementation is available and stat/mkdir are not overridden.</p>
<h1><a class="anchor" id="autotoc_md2075"></a>
implementation</h1>
<p>On Node.js v10.12.0 and above, use the native <code>fs.mkdir(p, {recursive:true})</code> option, unless <code>fs.mkdir</code>/<code>fs.mkdirSync</code> has been overridden by an option.</p>
<h2><a class="anchor" id="autotoc_md2076"></a>
native implementation</h2>
<ul>
<li>If the path is a root directory, then pass it to the underlying implementation and return the result/error. (In this case, it'll either succeed or fail, but we aren't actually creating any dirs.)</li>
<li>Walk up the path statting each directory, to find the first path that will be created, <code>made</code>.</li>
<li>Call <code>fs.mkdir(path, { recursive: true })</code> (or <code>fs.mkdirSync</code>)</li>
<li>If error, raise it to the caller.</li>
<li>Return <code>made</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2077"></a>
manual implementation</h2>
<ul>
<li>Call underlying <code>fs.mkdir</code> implementation, with <code>recursive: false</code></li>
<li>If error:<ul>
<li>If path is a root directory, raise to the caller and do not handle it</li>
<li>If ENOENT, mkdirp parent dir, store result as <code>made</code></li>
<li>stat(path)<ul>
<li>If error, raise original <code>mkdir</code> error</li>
<li>If directory, return <code>made</code></li>
<li>Else, raise original <code>mkdir</code> error</li>
</ul>
</li>
</ul>
</li>
<li>else<ul>
<li>return <code>undefined</code> if a root dir, or <code>made</code> if set, or <code>path</code></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md2078"></a>
windows vs unix caveat</h2>
<p>On Windows file systems, attempts to create a root directory (ie, a drive letter or root UNC path) will fail. If the root directory exists, then it will fail with <code>EPERM</code>. If the root directory does not exist, then it will fail with <code>ENOENT</code>.</p>
<p>On posix file systems, attempts to create a root directory (in recursive mode) will succeed silently, as it is treated like just another directory that already exists. (In non-recursive mode, of course, it fails with <code>EEXIST</code>.)</p>
<p>In order to preserve this system-specific behavior (and because it's not as if we can create the parent of a root directory anyway), attempts to create a root directory are passed directly to the <code>fs</code> implementation, and any errors encountered are not handled.</p>
<h2><a class="anchor" id="autotoc_md2079"></a>
native error caveat</h2>
<p>The native implementation (as of at least Node.js v13.4.0) does not provide appropriate errors in some cases (see <a href="https://github.com/nodejs/node/issues/31481">nodejs/node#31481</a> and <a href="https://github.com/nodejs/node/issues/28015">nodejs/node#28015</a>).</p>
<p>In order to work around this issue, the native implementation will fall back to the manual implementation if an <code>ENOENT</code> error is encountered.</p>
<h1><a class="anchor" id="autotoc_md2080"></a>
choosing a recursive mkdir implementation</h1>
<p>There are a few to choose from! Use the one that suits your needs best :D</p>
<h2><a class="anchor" id="autotoc_md2081"></a>
use &lt;tt&gt;fs.mkdir(path, {recursive: true}, cb)&lt;/tt&gt; if:</h2>
<ul>
<li>You wish to optimize performance even at the expense of other factors.</li>
<li>You don't need to know the first dir created.</li>
<li>You are ok with getting <code>ENOENT</code> as the error when some other problem is the actual cause.</li>
<li>You can limit your platforms to Node.js v10.12 and above.</li>
<li>You're ok with using callbacks instead of promises.</li>
<li>You don't need/want a CLI.</li>
<li>You don't need to override the <code>fs</code> methods in use.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2082"></a>
use this module (mkdirp 1.x) if:</h2>
<ul>
<li>You need to know the first directory that was created.</li>
<li>You wish to use the native implementation if available, but fall back when it's not.</li>
<li>You prefer promise-returning APIs to callback-taking APIs.</li>
<li>You want more useful error messages than the native recursive mkdir provides (at least as of Node.js v13.4), and are ok with re-trying on <code>ENOENT</code> to achieve this.</li>
<li>You need (or at least, are ok with) a CLI.</li>
<li>You need to override the <code>fs</code> methods in use.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2083"></a>
use &lt;a href="http://npm.im/make-dir" &gt;&lt;tt&gt;make-dir&lt;/tt&gt;&lt;/a&gt; if:</h2>
<ul>
<li>You do not need to know the first dir created (and wish to save a few <code>stat</code> calls when using the native implementation for this reason).</li>
<li>You wish to use the native implementation if available, but fall back when it's not.</li>
<li>You prefer promise-returning APIs to callback-taking APIs.</li>
<li>You are ok with occasionally getting <code>ENOENT</code> errors for failures that are actually related to something other than a missing file system entry.</li>
<li>You don't need/want a CLI.</li>
<li>You need to override the <code>fs</code> methods in use.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2084"></a>
use mkdirp 0.x if:</h2>
<ul>
<li>You need to know the first directory that was created.</li>
<li>You need (or at least, are ok with) a CLI.</li>
<li>You need to override the <code>fs</code> methods in use.</li>
<li>You're ok with using callbacks instead of promises.</li>
<li>You are not running on Windows, where the root-level ENOENT errors can lead to infinite regress.</li>
<li>You think vinyl just sounds warmer and richer for some weird reason.</li>
<li>You are supporting truly ancient Node.js versions, before even the advent of a <code>Promise</code> language primitive. (Please don't. You deserve better.)</li>
</ul>
<h1><a class="anchor" id="autotoc_md2085"></a>
cli</h1>
<p>This package also ships with a <code>mkdirp</code> command.</p>
<div class="fragment"><div class="line">$ mkdirp -h</div>
<div class="line"> </div>
<div class="line">usage: mkdirp [DIR1,DIR2..] {OPTIONS}</div>
<div class="line"> </div>
<div class="line">  Create each supplied directory including any necessary parent directories</div>
<div class="line">  that don&#39;t yet exist.</div>
<div class="line"> </div>
<div class="line">  If the directory already exists, do nothing.</div>
<div class="line"> </div>
<div class="line">OPTIONS are:</div>
<div class="line"> </div>
<div class="line">  -m&lt;mode&gt;       If a directory needs to be created, set the mode as an octal</div>
<div class="line">  --mode=&lt;mode&gt;  permission string.</div>
<div class="line"> </div>
<div class="line">  -v --version   Print the mkdirp version number</div>
<div class="line"> </div>
<div class="line">  -h --help      Print this helpful banner</div>
<div class="line"> </div>
<div class="line">  -p --print     Print the first directories created for each path provided</div>
<div class="line"> </div>
<div class="line">  --manual       Use manual implementation, even if native is available</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2086"></a>
install</h1>
<p>With <a href="http://npmjs.org">npm</a> do:</p>
<div class="fragment"><div class="line">npm install mkdirp</div>
</div><!-- fragment --><p>to get the library locally, or</p>
<div class="fragment"><div class="line">npm install -g mkdirp</div>
</div><!-- fragment --><p>to get the command everywhere, or</p>
<div class="fragment"><div class="line">npx mkdirp ...</div>
</div><!-- fragment --><p>to run the command without installing it globally.</p>
<h1><a class="anchor" id="autotoc_md2087"></a>
platform support</h1>
<p>This module works on node v8, but only v10 and above are officially supported, as Node v8 reached its LTS end of life 2020-01-01, which is in the past, as of this writing.</p>
<h1><a class="anchor" id="autotoc_md2088"></a>
license</h1>
<p>MIT </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
